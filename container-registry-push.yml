---
include:
  - remote: "https://raw.githubusercontent.com/jobtome-labs/ci-templates/feat/cloud-run-and-gcr/templates/container-registry-push.yml"

container-registry:push:quality:
  extends: .container-registry:push

  stage: push

  variables:
    IMAGE_TAG: ${CI_COMMIT_SHORT_SHA}

  only:
    - master
    - main
    - /^qa.+$/i

container-registry:push:production:
  extends: .container-registry:push

  stage: push

  variables:
    IMAGE_TAG: ${CI_COMMIT_TAG}

  only:
    - /^v.+$/i
  except:
    - branches
